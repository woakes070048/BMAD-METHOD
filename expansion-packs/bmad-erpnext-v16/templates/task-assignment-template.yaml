# Task Assignment Template
# Used by development-coordinator for assigning tasks to agents

name: task-assignment-template
version: 1.0.0
description: Template for assigning tasks to specialized agents with quality gate requirements

# ASSIGNMENT STRUCTURE
assignment:
  # Task identification
  task_id: "TASK-{timestamp}"
  task_type: "[TROUBLESHOOTING|NEW_DEVELOPMENT|ENHANCEMENT|MIGRATION]"
  priority: "[HIGH|MEDIUM|LOW]"
  
  # Task details
  task_description: |
    ## Task Summary
    [Brief description of what needs to be done]
    
    ## Context
    [Background information and why this task is needed]
    
    ## Success Criteria
    [What constitutes successful completion]
  
  # Agent assignment
  assigned_to:
    primary_agent: "[agent-id]"
    support_agents: []
    reviewer: "[reviewer-agent-id]"
  
  # Quality requirements
  quality_gates_required:
    pre_work:
      - context_detection
      - dependency_analysis
      - test_strategy
    
    during_work:
      - import_validation
      - frappe_compliance
      - incremental_testing
      - structure_adherence
    
    post_work:
      - full_test_suite
      - structure_validation
      - documentation_completeness
      - cross_verification
  
  # Dependencies
  dependencies:
    prerequisite_tasks: []
    required_resources:
      - tasks: []
      - templates: []
      - checklists: []
      - data: []
    
    blocking_tasks: []
    blocked_by: []
  
  # Timeline
  timeline:
    assigned_date: "[ISO-8601 timestamp]"
    expected_start: "[ISO-8601 timestamp]"
    expected_completion: "[ISO-8601 timestamp]"
    actual_start: null
    actual_completion: null
  
  # Constraints
  constraints:
    frappe_first_required: true
    multi_app_compatibility: ["frappe", "erpnext", "docflow", "n8n_integration"]
    performance_requirements:
      api_response_time: "< 2s"
      page_load_time: "< 3s"
    security_requirements:
      authentication_required: true
      permission_checks: true
      input_validation: true

# HANDOFF PREPARATION
handoff_requirements:
  from_agent: null
  to_agent: "[next-agent-id]"
  
  deliverables:
    code_artifacts: []
    documentation: []
    test_results: []
    known_issues: []
  
  quality_gate_status:
    gates_passed: []
    gates_failed: []
    gates_pending: []
  
  next_steps: |
    [Clear instructions for the next agent]

# TRACKING
tracking:
  status: "[PENDING|ASSIGNED|IN_PROGRESS|BLOCKED|TESTING|REVIEW|COMPLETED]"
  
  progress_updates: []
  # Example update:
  # - timestamp: "2024-01-15T10:30:00Z"
  #   agent: "api-developer"
  #   message: "Completed API endpoints, starting tests"
  #   progress_percentage: 60
  
  blockers: []
  # Example blocker:
  # - timestamp: "2024-01-15T11:00:00Z"
  #   description: "Missing DocType dependency"
  #   blocking_agent: "doctype-designer"
  #   resolution_required: "Need Customer DocType completed first"
  
  quality_gate_results: []
  # Example result:
  # - gate: "import_validation"
  #   status: "PASSED"
  #   timestamp: "2024-01-15T12:00:00Z"
  #   validator: "frappe-compliance-validator"

# ESCALATION
escalation:
  triggers:
    - missed_deadline
    - quality_gate_failures_exceeding: 3
    - blocked_duration_exceeding: "2 hours"
  
  escalation_path:
    level_1: "development-coordinator"
    level_2: "erpnext-product-owner"
    level_3: "erpnext-architect"
  
  notifications:
    on_assignment: ["assigned_agent"]
    on_completion: ["requester", "next_agent"]
    on_blocking: ["coordinator", "blocked_agent"]
    on_escalation: ["escalation_target", "product_owner"]

# VALIDATION RULES
validation:
  required_fields:
    - task_description
    - assigned_to.primary_agent
    - quality_gates_required
    - timeline.expected_completion
  
  agent_capability_check: true
  resource_availability_check: true
  dependency_resolution_check: true

# USAGE INSTRUCTIONS
usage:
  create_assignment: |
    1. Copy this template
    2. Fill in all required fields
    3. Validate agent capability matches task requirements
    4. Set quality gates based on task type
    5. Define clear success criteria
    6. Establish timeline with buffer
  
  track_progress: |
    1. Update status as work progresses
    2. Log progress updates regularly
    3. Document any blockers immediately
    4. Record quality gate results
  
  prepare_handoff: |
    1. Ensure all quality gates passed
    2. Document deliverables clearly
    3. List any known issues
    4. Provide clear next steps
    5. Update handoff_requirements section

# INTEGRATION
integration:
  workflows:
    - coordination-workflow.yaml
    - quality-gate-enforcement-workflow.yaml
  
  triggers:
    on_creation: "notify_assigned_agent"
    on_update: "update_tracking_metrics"
    on_completion: "trigger_quality_gates"
    on_handoff: "validate_handoff_requirements"