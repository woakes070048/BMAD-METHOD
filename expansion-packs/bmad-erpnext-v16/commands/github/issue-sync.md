# GitHub Issue Sync Command

## Command: /github:issue-sync

### Purpose
Sync current development progress to the associated GitHub issue as comments.

### Usage
```
/github:issue-sync [issue_number]
```
If no issue number provided, uses current GitHub context.

### Prerequisites
- GitHub CLI (`gh`) must be installed and authenticated
- Issue context must be established (via `/github:issue-fetch`)
- Development work in progress

### Process

#### 1. Gather Progress Information
```bash
# Check current BMAD session
cat SESSION-CHANGELOG.md

# Get current git status
git status --porcelain

# Check quality gate results
find .bmad-project/quality-reports/ -name "*.md" -newer .bmad-project/last-sync.timestamp

# Get agent progress
find .bmad-project/handoffs/ -name "*.md" -newer .bmad-project/last-sync.timestamp
```

#### 2. Create Progress Summary
Generate structured progress update:
```markdown
## ü§ñ AI Development Progress Update

**Timestamp**: $(date)
**Session ID**: ${SESSION_ID}
**Mode**: ${EXECUTION_MODE}

### Work Completed
- [Agent] [Task] - [Status]
- [Agent] [Task] - [Status]

### Quality Gates
- ‚úÖ Structure Validation: Passed
- ‚úÖ Test Execution: Passed  
- ‚ö†Ô∏è Documentation: Needs Review
- ‚ùå Integration Tests: Failed (details below)

### Files Modified
- `path/to/file1.py` - DocType modifications
- `path/to/file2.js` - Vue component updates
- `path/to/file3.json` - Workflow configuration

### Current Status
[In Progress/Completed/Blocked]

### Next Steps
- [Next planned work]
- [Dependencies to resolve]

### Issues/Blockers
- [Any blocking issues]

---
*Generated by BMAD ERPNext v16 ‚Ä¢ [Claude Code](https://claude.ai/code)*
```

#### 3. Post to GitHub Issue
```bash
# Create comment body
COMMENT_BODY=$(cat << 'EOF'
${progress_summary}
EOF
)

# Post comment
gh issue comment ${issue_number} --body "${COMMENT_BODY}"

# Update sync timestamp
touch .bmad-project/last-sync.timestamp
```

#### 4. Handle Different Progress Types

**Mode-Specific Updates:**

**Guided Mode:**
```markdown
### Interactive Progress (Guided Mode)
- User approved: [Agent] [Task]
- Currently reviewing: [Current step]
- Awaiting approval: [Next step]
```

**Sequential Mode:**
```markdown
### Batch Progress (Sequential Mode)
- Stories completed: 3/7
- Current story: #1235 "Add validation logic"
- ETA: ~15 minutes remaining
```

**Smart Parallel Mode:**
```markdown
### Parallel Execution (Smart Parallel Mode)
**Block 1** (Completed ‚úÖ):
- doctype-designer: Customer DocType ‚úÖ
- api-architect: API structure ‚úÖ

**Block 2** (In Progress üîÑ):
- api-developer: API implementation 60%
- vue-spa-architect: UI components 75%

**Conflicts Detected**: None
**Fallback Triggered**: No
```

#### 5. Quality Gate Failure Reporting
When quality gates fail:
```markdown
## ‚ö†Ô∏è Quality Gate Failure

**Failed Gate**: Integration Tests
**Agent**: api-developer
**Details**: 
- Test `test_customer_api_validation` failed
- Error: ValidationError on missing required field

**Recovery Action**: 
- Paused dependent agents
- Fixing validation logic
- ETA: 10 minutes

**Impact**: 
- vue-spa-architect paused (dependent on API)
- doctype-designer continues (independent)
```

### Output Formats

#### Success Response
```
‚úÖ Progress synced to GitHub Issue #1234
üìä Updated: 3 completed tasks, 2 in progress
üîó Comment posted: https://github.com/user/repo/issues/1234#issuecomment-123456
```

#### Failure Response
```
‚ùå Sync failed: Authentication error
üí° Run: gh auth login
```

### Configuration Options
Set in config.yaml:
```yaml
github_integration:
  sync_on_handoff: true           # Auto-sync after each handoff
  post_progress: true             # Include progress details
  comment_on_gate_failures: true  # Post when gates fail
  update_interval: "on_completion" # When to sync
```

### Auto-Sync Triggers
- After successful agent handoff
- After quality gate completion (pass or fail)
- After parallel block completion
- On workflow completion
- On error/escalation

### Privacy Controls
- Sensitive information filtered out
- Local file paths anonymized
- Error details sanitized
- Only public-safe information posted

### Integration Points
- Called automatically by coordination-workflow
- Triggered by quality-gate-enforcement-workflow
- Used by parallel-failure-recovery-workflow

### Related Commands
- `/github:issue-fetch` - Establish issue context
- `/github:comment` - Post custom comment
- `/github:setup` - Configure GitHub integration